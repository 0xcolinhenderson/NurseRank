{% extends "base.html" %}
{% block title %}NurseRank: Account{% endblock %}
{% block content %}
<div class="container mt-5">
  <div class="table-wrapper">
    <table class="table table-dark table-condensed table-bordered" style="margin-top: 0px;" id="nursesTable">
      <thead>
        <tr>
          <th scope="col" class="sortable" onclick="sortTable(0)">ID <span></span></th>
          <th scope="col" class="sortable" onclick="sortTable(1)">Last Name <span></span></th>
          <th scope="col" class="sortable" onclick="sortTable(2)">First Name <span></span></th>
          <th scope="col" class="sortable" onclick="sortTable(3)">Department ID <span></span></th>
          <th scope="col" class="sortable" onclick="sortTable(4)">Department <span></span></th>
          <th scope="col" class="sortable" onclick="sortTable(5)">Rank <span></span></th>
          <th scope="col" class="sortable" onclick="sortTable(6)">Manager Last Name <span></span></th>
          <th scope="col" class="sortable" onclick="sortTable(7)">Current Status <span></span></th>
          <th scope="col" class="sortable" onclick="sortTable(8)">Upcoming Renewal Date <span></span></th>
          <th scope="col" class="sortable" onclick="sortTable(9)">Healthstream <span></span></th>
        </tr>
      </thead>
      <tbody>
        {% for nurse in nurses %}
        <tr>
          <td>{{ nurse.id }}</td>
          <td>{{ nurse.lastname }}</td>
          <td>{{ nurse.firstname }}</td>
          <td>{{ nurse.department_id }}</td>
          <td>{{ nurse.department_name }}</td>
          <td>{{ nurse.rn_level }}</td>
          <td>{{ nurse.manager }}</td>
          <td>{{ nurse.status}}</td>
          <td>Dates</td>
          <td>{% if nurse.healthstream %}✓{% else %}✗{% endif %}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
<script src="../assets/dist/js/bootstrap.bundle.min.js"></script>
<script>
function sortTable(columnIndex) {
  var table = document.getElementById("nursesTable");
  var rows = table.getElementsByTagName("TR");
  var switching = true;
  var shouldSwitch;
  var direction = "asc";
  var switchcount = 0;

  // Clear previous sorting indicators
  var headers = table.getElementsByTagName("TH");
  for (var i = 0; i < headers.length; i++) {
    headers[i].style.color = "";
    headers[i].querySelector("span").innerHTML = "";
  }

  while (switching) {
    switching = false;
    var rowsArray = Array.prototype.slice.call(rows, 1); // Skip the header row
    for (var i = 0; i < (rowsArray.length - 1); i++) {
      shouldSwitch = false;
      var x = rowsArray[i].getElementsByTagName("TD")[columnIndex];
      var y = rowsArray[i + 1].getElementsByTagName("TD")[columnIndex];
      if (direction == "asc") {
        if (x.innerHTML.toLowerCase() > y.innerHTML.toLowerCase()) {
          shouldSwitch = true;
          break;
        }
      } else if (direction == "desc") {
        if (x.innerHTML.toLowerCase() < y.innerHTML.toLowerCase()) {
          shouldSwitch = true;
          break;
        }
      }
    }
    if (shouldSwitch) {
      rowsArray[i].parentNode.insertBefore(rowsArray[i + 1], rowsArray[i]);
      switching = true;
      switchcount++;
    } else {
      if (switchcount == 0 && direction == "asc") {
        direction = "desc";
        switching = true;
      }
    }
  }
  // Set the sorted column header color and symbol
  var sortedHeader = headers[columnIndex];
  sortedHeader.style.color = "var(--orange)";
  sortedHeader.querySelector("span").innerHTML = direction == "asc" ? "▲" : "▼";
}
</script>
{% endblock %}
